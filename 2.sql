
  -------------------- SQL OF 2 -------------------------


DELETE FROM EPAY_CUST_MASTER_DATA_GPR_X;

COMMIT;
    
INSERT INTO EPAY_CUST_MASTER_DATA_GPR_X
(COMPANY_CODE,ACCOUNT_NO,NAME,LOCATION_CODE,AREAR_CODE,ACTIVATION_DATE,STATUS,CREATED_ON ,DUMPING_FOR, CREATED_BY)
SELECT 'BPDB', CUSTOMER_NUM||CHECK_DIGIT,CUSTOMER_NAME,LOCATION_CODE,AREA_CODE,  TO_DATE(START_BILL_CYCLE,'rrrrmm'),
DECODE (CUSTOMER_STATUS_CODE,'C','A','S','A','I') STATUS,  SYSDATE,    'U','ROBIBPDB' 
FROM BC_CUSTOMERS@BILLING_KISHOR
WHERE (CUSTOMER_NUM,LOCATION_CODE) IN (SELECT SUBSTR(ACCOUNT_NUMBER,1,7),LOCATION_CODE FROM EPAY_UTILITY_BILL_GPR_X);

COMMIT;

DELETE FROM EPAY_CUST_MASTER_DATA_GPR_X
WHERE ROWID IN ( 
SELECT ROWID FROM EPAY_CUST_MASTER_DATA_GPR_X
MINUS 
SELECT MAX(ROWID) FROM EPAY_CUST_MASTER_DATA_GPR_X
GROUP BY COMPANY_CODE, ACCOUNT_NO, LOCATION_CODE);

COMMIT;

-------------------- SQL OF 3 -------------ROBI------------

INSERT INTO CUSTOMER_MASTER_DATA_PDB@EPAY_ROBI
SELECT * FROM EPAY_CUST_MASTER_DATA_GPR_X
WHERE ( ACCOUNT_NO, LOCATION_CODE) IN ( 
SELECT  ACCOUNT_NO, LOCATION_CODE FROM EPAY_CUST_MASTER_DATA_GPR_X
WHERE LOCATION_CODE IN (SELECT LOCATION_CODE FROM EPAY_LOCATION_MASTER)
MINUS 
SELECT  ACCOUNT_NO,LOCATION_CODE FROM CUSTOMER_MASTER_DATA_PDB@EPAY_ROBI
WHERE  LOCATION_CODE IN (SELECT LOCATION_CODE FROM EPAY_LOCATION_MASTER)
);

COMMIT;

--------------------GP--------------GP---------

INSERT INTO DBERSICE.CUSTOMER_MASTER_DATA_PDB@EPAY_GP
SELECT * FROM EPAY_CUST_MASTER_DATA_GPR_X
WHERE ( ACCOUNT_NO, LOCATION_CODE) IN ( 
SELECT  ACCOUNT_NO, LOCATION_CODE FROM EPAY_CUST_MASTER_DATA_GPR_X
WHERE LOCATION_CODE IN (SELECT LOCATION_CODE FROM EPAY_LOCATION_MASTER)
MINUS 
SELECT  ACCOUNT_NO,LOCATION_CODE FROM DBERSICE.CUSTOMER_MASTER_DATA_PDB@EPAY_GP
WHERE  LOCATION_CODE IN (SELECT LOCATION_CODE FROM EPAY_LOCATION_MASTER)
);

COMMIT;

---------------------SRL---------SEBL------------------------

INSERT INTO EPAY_CUSTOMER_MASTER_DATA@EPAY_SRL
SELECT * FROM EPAY_CUST_MASTER_DATA_GPR_X
WHERE ( ACCOUNT_NO) IN ( 
SELECT  ACCOUNT_NO FROM EPAY_CUST_MASTER_DATA_GPR_X
WHERE LOCATION_CODE IN (SELECT LOCATION_CODE FROM EPAY_LOCATION_MASTER)
MINUS 
SELECT  ACCOUNT_NO FROM EPAY_CUSTOMER_MASTER_DATA@EPAY_SRL
WHERE  LOCATION_CODE IN (SELECT LOCATION_CODE FROM EPAY_LOCATION_MASTER)
);

COMMIT;

--------------------PDB---------------

INSERT INTO EPAY_CUSTOMER_MASTER_DATA
SELECT * FROM EPAY_CUST_MASTER_DATA_GPR_X
WHERE ( ACCOUNT_NO) IN ( 
SELECT  ACCOUNT_NO FROM EPAY_CUST_MASTER_DATA_GPR_X
WHERE LOCATION_CODE IN (SELECT LOCATION_CODE FROM EPAY_LOCATION_MASTER)
MINUS 
SELECT  ACCOUNT_NO FROM EPAY_CUSTOMER_MASTER_DATA
WHERE  LOCATION_CODE IN (SELECT LOCATION_CODE FROM EPAY_LOCATION_MASTER)
);

COMMIT;
