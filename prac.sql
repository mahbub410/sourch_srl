
SELECT CU.CUSTOMER_NAME,CU.LOCATION_CODE,CU.AREA_CODE,IH.BILL_CYCLE_CODE,IH.INVOICE_NUM,SUM(IH.PRINCIPAL_AMT+IH.PRINCIPAL_ADJ+IH.VAT_AMT+IH.VAT_ADJ)
TOT_AMT,SUM(IH.PRINCIPAL_APPL+IH.VAT_APPL) TOT_PAID_AMT,SUM(IH.PRINCIPAL_AMT+IH.PRINCIPAL_ADJ+IH.VAT_AMT+IH.VAT_ADJ)-SUM(IH.PRINCIPAL_APPL+IH.VAT_APPL)
TOT_DUE_AMT 
FROM BC_INVOICE_HDR IH,BC_CUSTOMERS CU
WHERE IH.CUST_ID=CU.CUST_ID
AND IH.CUST_NUM=CU.CUSTOMER_NUM
AND IH.CUST_NUM='6710297'
GROUP BY  CU.CUSTOMER_NAME,CU.LOCATION_CODE,CU.AREA_CODE,IH.BILL_CYCLE_CODE,IH.INVOICE_NUM
ORDER BY IH.BILL_CYCLE_CODE DESC




SELECT CU.CUSTOMER_NAME,CU.LOCATION_CODE,CU.AREA_CODE,IH.BILL_CYCLE_CODE,IH.INVOICE_NUM,IH.INVOICE_DUE_DATE,RH.RECEIPT_DATE , 
SUM(IH.PRINCIPAL_AMT+IH.PRINCIPAL_ADJ+IH.VAT_AMT+IH.VAT_ADJ)
TOT_AMT,SUM(RH.RECEIPT_AMT+RH.VAT_AMT ) TOT_PAID_AMT,SUM(IH.PRINCIPAL_AMT+IH.PRINCIPAL_ADJ+IH.VAT_AMT+IH.VAT_ADJ)-SUM(IH.PRINCIPAL_APPL+IH.VAT_APPL)
TOT_DUE_AMT 
FROM BC_INVOICE_HDR IH,BC_CUSTOMERS CU,BC_RECEIPT_HDR RH
WHERE IH.CUST_ID=CU.CUST_ID
AND IH.CUST_NUM=CU.CUSTOMER_NUM
AND IH.INVOICE_NUM=RH.INVOICE_NUM
AND IH.CUST_NUM=RH.CUST_NUM
AND IH.CUST_ID=RH.CUST_ID
AND IH.CUST_NUM='6710297'
GROUP BY  CU.CUSTOMER_NAME,CU.LOCATION_CODE,CU.AREA_CODE,IH.BILL_CYCLE_CODE,IH.INVOICE_NUM,IH.INVOICE_DUE_DATE,RH.RECEIPT_DATE
ORDER BY IH.BILL_CYCLE_CODE DESC



MD. SAMSUZZAMAN    L1    A4302    201810    28824827    12-Nov-18    11-Nov-18    1056.25    1056.25    0
MD. SAMSUZZAMAN    L1    A4302    201808    28591634    10-Sep-18    10-Sep-18    1356    1356    0
MD. SAMSUZZAMAN    L1    A4302    201807    28470422    09-Aug-18    07-Aug-18    1446    1446    0
MD. SAMSUZZAMAN    L1    A4302    201806    28356066    09-Jul-18    09-Jul-18    1296    1296    0
MD. SAMSUZZAMAN    L1    A4302    201805    28239033    10-Jun-18    09-Jun-18    1000    1000    0



SELECT * FROM BC_BILL_IMAGE

SELECT * FROM BC_INVOICE_HDR

WHERE INVOICE_NUM='10010995'


SELECT * FROM BC_RECEIPT_HDR
WHERE INVOICE_NUM='10014140'


SELECT * FROM BC_INVOICE_HDR
WHERE CUST_NUM='6710297'

INVOICE_NUM='10014140'


SELECT * FROM BC_CUSTOMERS


SELECT B.INVOICE_DUE_DATE, A.RECEIPT_DATE FROM BC_RECEIPT_HDR A,BC_INVOICE_HDR B
WHERE A.INVOICE_NUM=B.INVOICE_NUM
AND B.INVOICE_NUM='10010995'
--AND B.CUST_NUM='6710297'
ORDER BY 2 DESC


'10010995'