select C.LOCATION_CODE,SUBSTR(C.AREA_CODE,1,3) BOOK,SUBSTR(C.AREA_CODE,4) BG,C.CONS_EXTG_NUM AC,b.TARIFF,C.WALKING_SEQUENCE PAGE,C.CUSTOMER_NAME NAME
,A.ADDR_DESCR1||'-'||A.ADDR_DESCR2 ADDRESS, C.CUSTOMER_NUM ||C.CHECK_DIGIT CUST_NUM,B.METER_NUM_KWH METER,B.METER_STATUS ST,b.TOTAL_BILL
from bc_CUSTOMERS C,BC_BILL_IMAGE B,BC_CUSTOMER_ADDR A
where C.CUST_ID=A.CUST_ID
AND A.ADDR_TYPE='B'
AND A.ADDR_EXP_DATE IS NULL
AND C.CUST_ID=B.CUST_ID
AND B.BILL_CYCLE_CODE='201812'
and (b.cust_id in(
select cust_id from bc_bill_image 
minus
select cust_id from bc_receipt_hdr
where RECEIPT_TYPE_CODE='REC'and receipt_date<='30-dec-2018'))
and C.LOCATION_CODE='M2' 
order by SUBSTR(C.AREA_CODE,1,3),SUBSTR(C.AREA_CODE,4),C.WALKING_SEQUENCE